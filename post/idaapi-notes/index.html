<!DOCTYPE html>
<html class="no-js" lang="en-us" scroll-behavior="smooth"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="IDAAPI quick reference notes">
    <meta name="author" content="Steven">

    <!-- Mobile Specific Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.74.3" />

    <title>IDAAPI Notes | Posts</title>


    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="https://l1nna.com/images/favicon.ico"/>

    <!-- CSS -->
    <!-- Fontawesome Icon font -->
    <link rel="stylesheet" href="https://l1nna.com/plugins/themefisher-font/style.css">
    <!-- bootstrap.min css -->
    <link rel="stylesheet" href="https://l1nna.com/plugins/bootstrap/dist/css/bootstrap.min.css">
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://l1nna.com/plugins/animate-css/animate.css">
    <!-- Magnific popup css -->
    <link rel="stylesheet" href="https://l1nna.com/plugins/magnific-popup/dist/magnific-popup.css">
    <!-- Slick Carousel -->
    <link rel="stylesheet" href="https://l1nna.com/plugins/slick-carousel/slick/slick.css">
    <link rel="stylesheet" href="https://l1nna.com/plugins/slick-carousel/slick/slick-theme.css">
    <!-- Main Stylesheet -->
    
    <link rel="stylesheet" href="https://l1nna.com/css/style.min.css" integrity="" media="screen">

</head>
<body id="body" data-spy="scroll" data-target=".navbar" data-offset="52">
        <div id="content">

<!-- Fixed Navigation -->
<nav id="navigation" class="navbar navbar-expand-lg navigation sticky-top">
        <div class="container-fluid">

                <!-- logo -->
                <a class="navbar-brand logo" href="https://l1nna.com/">
                        <img src="https://l1nna.com/images/logo_ls.png" alt="Logo" />
                        <span class="pl-2 font-weight-bold">L1NNA</span>
                </a>
                <!-- /logo -->

                <!-- responsive nav button -->
                <button class="navbar-toggler navbar-dark" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                </button>
                <!-- /responsive nav button -->

                <!-- main nav -->
                
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav ml-auto navigation-menu">
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://l1nna.com/#body">Home</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://l1nna.com/#our-team">Team</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://l1nna.com/#hiring">Opportunities</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://l1nna.com/#projects">Projects</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://l1nna.com/#publications">Publications</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://l1nna.com/#courses">Courses</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://l1nna.com/#blogs">Blogs</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://l1nna.com/#sponsor">Funding</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://l1nna.com/#contact">Contact</a></li>
                                
                        </ul>
                </div>
                
                <!-- /main nav -->
        </div>

</nav>
<!-- End Fixed Navigation -->


<section class="section bg-1-c bg-1-c-d overly single-post-default">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-8 offset-lg-2 text-center single-post-header course-block  wow fadeInLeft" data-wow-duration="1000ms"
                style="background-image: url(https://picsum.photos/1024/400/?image=1078)">
                <div class="caption">
                    <h1>IDAAPI Notes</h1>
                                        <h5>IDAAPI quick reference notes</h5>
                    <ul class="list-inline mb-50">
                        <li class="list-inline-item"><a
                                href="/author/steven">Steven</a></li>
                        <li class="list-inline-item">Monday, Jan 1, 0001</li>
                    </ul>
                </div>
                
            </div>
            <div class="col-lg-8 offset-lg-2">
                <div class="post-single-content default bg-one  wow fadeInLeft" data-wow-duration="1000ms" data-wow-delay="100ms">
                    <h2 id="force-creation-of-an-assembly-function">Force creation of an assembly function:</h2>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># get address from unstripped file</span>
<span class="k">def</span> <span class="nf">check</span><span class="p">():</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">get_func</span><span class="p">(</span><span class="n">ScreenEA</span><span class="p">())</span>
    <span class="k">print</span> <span class="p">[</span><span class="nb">hex</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">startEA</span><span class="p">),</span> <span class="nb">hex</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">endEA</span><span class="p">)]</span>

<span class="c1"># create function in stripped file</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">ea_start</span><span class="p">,</span> <span class="n">ea_end</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ea_start</span><span class="p">,</span> <span class="n">ea_end</span><span class="p">):</span> 
        <span class="n">idaapi</span><span class="o">.</span><span class="n">create_insn</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
    <span class="n">MakeFunction</span><span class="p">(</span><span class="n">ea_start</span><span class="p">,</span> <span class="n">ea_end</span><span class="p">)</span>
</code></pre></div><h2 id="remove-stack-reference-name-in-current-function">Remove stack reference name in current function:</h2>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">unstack</span><span class="p">():</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">get_func</span><span class="p">(</span><span class="n">ScreenEA</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">startEA</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">endEA</span><span class="p">):</span> 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">idc</span><span class="o">.</span><span class="n">OpOff</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</code></pre></div>
                    
                    

                </div>
            </div>
        </div>
    </div>
</section>


        </div><!-- end Contact Area -->
<footer id="footer" class="bg-one">
	<div class="container">
		<div class="row wow fadeInUp" data-wow-duration="500ms">
			<div class="col-xl-12">

				<!-- Footer Social Links -->
				

				<!-- copyright -->
				<div class="copyright text-center">
					<a href="https://l1nna.com/">
						<img src="https://l1nna.com/images/logo_ls.png" alt="Meghna" />
					</a>
					<br>

					<p>Design And Developed by <a href="https://l1nna.com/">
							 Steven. Powered by the theme from the Themefisher Team  </a>. Copyright &copy;
						<script>
							document.write(new Date().getFullYear())
						</script>. All Rights Reserved.</p>
				</div>
			</div>
		</div>
	</div>
</footer>
<!-- /footer -->

<!-- Essential Scripts -->

<!-- Main jQuery -->
<script type="text/javascript" src="https://l1nna.com/plugins/jquery/dist/jquery.min.js"></script>
<!-- Bootstrap 4.3 + Popper -->
<script type="text/javascript" src="https://l1nna.com/plugins/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<!-- Slick Carousel -->
<script type="text/javascript" src="https://l1nna.com/plugins/slick-carousel/slick/slick.min.js"></script>
<!-- Portfolio Filtering -->
<script type="text/javascript" src="https://l1nna.com/plugins/mixitup/mixitup.min.js"></script>
<!-- Magnific popup -->
<script type="text/javascript" src="https://l1nna.com/plugins/magnific-popup/dist/jquery.magnific-popup.min.js"></script>
<!-- Google Map API -->
<script type="text/javascript" src="https://l1nna.com/"></script>
<!-- Number Counter Script -->
<script type="text/javascript" src="https://l1nna.com/plugins/count-to/jquery.countTo.js"></script>
<!-- wow.min Script -->
<script type="text/javascript" src="https://l1nna.com/plugins/wow/dist/wow.min.js"></script>
<!-- Scroll behavior polyfill -->

<script src="https://l1nna.com/js/scroll-behavior-polyfill.min.js"></script>
<!-- Sweet Alert -->
<script type="text/javascript" src="https://l1nna.com/plugins/sweet-alert/sweetalert.min.js"></script>
<!-- Custom js -->

<script src="https://l1nna.com/js/script.min.js"></script>



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-77868521-2"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag() { dataLayer.push(arguments); }
	gtag('js', new Date());
	gtag('config', 'UA-77868521-2');
</script>


</body>

</html></body>
</html>
